echo "Running pre-commit..."

if [ -f ".git/MERGE_HEAD" ] || [ -n "$GIT_PULL" ] || [ -n "$CI" ]; then
  echo "Skipping pre-commit for merge/pull/CI operation."
  exit 0
fi

if git diff --cached --quiet; then
  echo "No staged files. Aborting commit."
  exit 1
fi

echo "Linting & formatting staged files (lint-staged)â€¦"
npx lint-staged || {
  echo "lint-staged failed."
  exit 1
}

echo "Pre-commit passed!"
exit 0
